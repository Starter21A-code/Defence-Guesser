<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Defence Guesser - Origin Identification</title>

    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#00ff88">
    <meta name="description"
        content="Test your military knowledge! Identify the origin of defence equipment from around the world.">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="DefenceGuesser">
    <meta name="mobile-web-app-capable" content="yes">

    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">

    <!-- Icons for various platforms -->
    <link rel="icon" type="image/png" sizes="96x96" href="assets/icon-96.png">
    <link rel="apple-touch-icon" href="assets/icon-192.png">

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;800&display=swap" rel="stylesheet">

    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
        integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />

    <link rel="stylesheet" href="style.css">
</head>

<body>

    <div id="app">
        <!-- Start Screen -->
        <div id="start-screen" class="screen active">
            <div class="glass-panel start-panel">
                <h1>DEFENCE<span class="highlight">GUESSER</span></h1>
                <p>Identify the origin technology. Secure the intel.</p>
                <div class="start-buttons">
                    <button id="start-btn" class="btn primary">START GAME</button>
                    <button id="daily-btn" class="btn daily">DAILY CHALLENGE</button>
                </div>
                <button id="practice-btn" class="btn secondary">PRACTICE HUB</button>
            </div>

            <!-- Daily Leaderboard Preview on Start Screen -->
            <div class="leaderboard-preview" id="leaderboard-preview">
                <h3>üèÜ TODAY'S TOP SCORES</h3>
                <div class="leaderboard-mini" id="leaderboard-mini">
                    <p class="no-scores">No scores yet today. Be the first!</p>
                </div>
            </div>
        </div>

        <!-- Daily Challenge Name Entry Modal -->
        <div id="daily-name-modal" class="modal hidden">
            <div class="modal-content">
                <h2>DAILY <span class="highlight">CHALLENGE</span></h2>
                <p>Enter your callsign for the leaderboard:</p>
                <input type="text" id="player-name-input" placeholder="Your callsign..." maxlength="20">
                <div class="modal-buttons">
                    <button id="daily-start-btn" class="btn primary">BEGIN MISSION</button>
                    <button id="daily-cancel-btn" class="btn secondary">CANCEL</button>
                </div>
                <p class="daily-info">Same 5 targets for all players today!</p>
            </div>
        </div>

        <!-- Practice Hub Screen -->
        <div id="practice-screen" class="screen hidden">
            <div class="practice-container">
                <div class="practice-header">
                    <button id="practice-back-btn" class="back-btn">‚Üê BACK</button>
                    <h2>PRACTICE <span class="highlight">HUB</span></h2>
                    <p>Familiarize yourself with defence equipment</p>
                </div>

                <div class="category-selector">
                    <button class="category-btn active" data-category="all">ALL</button>
                    <button class="category-btn" data-category="Main Battle Tank">TANKS</button>
                    <button class="category-btn" data-category="Fighter Aircraft">AIRCRAFT</button>
                    <button class="category-btn" data-category="Naval Vessel">NAVAL</button>
                    <button class="category-btn" data-category="Air Defense System">AIR DEFENSE</button>
                    <button class="category-btn" data-category="Artillery">ARTILLERY</button>
                    <button class="category-btn" data-category="Combat Drone">DRONES</button>
                    <button class="category-btn" data-category="Assault Rifle">RIFLES</button>
                </div>

                <div class="equipment-grid" id="equipment-grid">
                    <!-- Equipment cards will be generated by JavaScript -->
                </div>
            </div>

            <!-- Equipment Detail Modal -->
            <div id="practice-detail-modal" class="practice-modal hidden">
                <div class="practice-modal-content">
                    <button id="close-practice-modal" class="close-btn">‚úï</button>
                    <img id="practice-modal-image" src="" alt="Equipment">
                    <div class="practice-modal-info">
                        <h3 id="practice-modal-name"></h3>
                        <p class="practice-modal-origin" id="practice-modal-origin"></p>
                        <div class="practice-modal-specs">
                            <div class="spec-row">
                                <span class="spec-label">TYPE:</span>
                                <span class="spec-value" id="practice-modal-type"></span>
                            </div>
                            <div class="spec-row">
                                <span class="spec-label">SPEED:</span>
                                <span class="spec-value" id="practice-modal-speed"></span>
                            </div>
                            <div class="spec-row">
                                <span class="spec-label">ARMAMENT:</span>
                                <span class="spec-value" id="practice-modal-armament"></span>
                            </div>
                            <div class="spec-row">
                                <span class="spec-label">RANGE:</span>
                                <span class="spec-value" id="practice-modal-range"></span>
                            </div>
                            <div class="spec-row">
                                <span class="spec-label">IN SERVICE:</span>
                                <span class="spec-value" id="practice-modal-service"></span>
                            </div>
                            <div class="spec-row">
                                <span class="spec-label">STATUS:</span>
                                <span class="spec-value" id="practice-modal-status"></span>
                            </div>
                            <div class="spec-row full-width">
                                <span class="spec-label">OPERATORS:</span>
                                <span class="spec-value" id="practice-modal-users"></span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Game Screen -->
        <div id="game-screen" class="screen hidden">
            <div class="top-bar">
                <div class="score-container">SCORE: <span id="score">0</span></div>
                <div class="round-container">ROUND: <span id="round">1</span></div>
            </div>

            <!-- Fullscreen Map -->
            <div class="map-container-fullscreen">
                <div id="map"></div>
                <button id="guess-btn" class="btn primary">CONFIRM DROP</button>
            </div>

            <!-- Equipment Image Popup Overlay -->
            <div id="equipment-popup" class="equipment-popup">
                <button id="close-equipment" class="close-btn" title="Minimize">‚úï</button>
                <img id="equipment-image" src="" alt="Classified Equipment">
                <div class="loader">Accessing Archive...</div>
                <div class="specs-overlay hidden" id="specs-container">
                    <h3>INTEL RECORD</h3>
                    <p><strong>SPEED:</strong> <span id="spec-speed"></span></p>
                    <p><strong>ARMAMENT:</strong> <span id="spec-armament"></span></p>
                    <p><strong>RANGE:</strong> <span id="spec-range"></span></p>
                </div>
            </div>

            <!-- Minimized Equipment Thumbnail (Bottom Right) -->
            <div id="equipment-thumbnail" class="equipment-thumbnail hidden">
                <img id="thumbnail-image" src="" alt="Equipment">
            </div>
        </div>

        <!-- Result Screen (Overlay) -->
        <div id="result-screen" class="screen hidden">
            <div class="glass-panel result-panel">
                <h2 id="result-title">TARGET ACQUIRED</h2>

                <div class="result-details">
                    <p>Actual Origin: <span id="actual-origin" class="highlight">Unknown</span></p>
                    <p>Distance Error: <span id="distance-error">0</span> km</p>
                    <p>Points Awarded: +<span id="points-awarded">0</span></p>
                </div>

                <div class="bonus-section" id="bonus-section">
                    <h3>BONUS INTEL (+2500 pts)</h3>
                    <p>Identify the equipment:</p>
                    <div class="bonus-choices" id="bonus-choices">
                        <!-- Choices will be generated by JavaScript -->
                    </div>
                    <p id="bonus-result" class="bonus-result"></p>
                </div>

                <!-- Equipment Summary Section -->
                <div class="equipment-summary hidden" id="equipment-summary">
                    <h3>EQUIPMENT PROFILE</h3>
                    <div class="summary-grid">
                        <div class="summary-item">
                            <span class="summary-label">IN SERVICE:</span>
                            <span class="summary-value" id="summary-year">-</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">OPERATIONAL STATUS:</span>
                            <span class="summary-value" id="summary-status">-</span>
                        </div>
                        <div class="summary-item full-width">
                            <span class="summary-label">CURRENT USERS:</span>
                            <span class="summary-value" id="summary-users">-</span>
                        </div>
                    </div>
                </div>

                <button id="next-btn" class="btn secondary">NEXT TARGET</button>
            </div>
        </div>

        <!-- Game Over Screen -->
        <div id="game-over-screen" class="screen hidden">
            <div class="debrief-container">
                <div class="debrief-header">
                    <h1>MISSION <span class="highlight">DEBRIEF</span></h1>
                    <p class="debrief-subtitle">Intelligence Assessment Complete</p>
                </div>

                <div class="debrief-content">
                    <!-- Score Summary -->
                    <div class="score-summary">
                        <div class="final-score-display">
                            <span class="score-label">FINAL SCORE</span>
                            <span class="score-value" id="final-score">0</span>
                        </div>
                        <div class="score-rating" id="score-rating">
                            <span class="rating-label">PERFORMANCE RATING</span>
                            <span class="rating-value" id="rating-value">RECRUIT</span>
                        </div>
                        <div class="score-stats">
                            <div class="stat-item">
                                <span class="stat-value" id="stat-correct-locations">0</span>
                                <span class="stat-label">Correct Locations</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-value" id="stat-correct-ids">0</span>
                                <span class="stat-label">Correct IDs</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-value" id="stat-accuracy">0%</span>
                                <span class="stat-label">Accuracy</span>
                            </div>
                        </div>
                    </div>

                    <!-- Round Breakdown -->
                    <div class="rounds-breakdown">
                        <h3>ROUND BREAKDOWN</h3>
                        <div class="rounds-list" id="rounds-list">
                            <!-- Round items will be generated by JavaScript -->
                        </div>
                    </div>

                    <!-- Daily Leaderboard (only shown for daily challenge) -->
                    <div class="daily-leaderboard-section hidden" id="daily-leaderboard-section">
                        <div class="placement-message" id="placement-message">
                            <!-- Placement message will be generated by JavaScript -->
                        </div>
                        <h3>üèÜ TODAY'S LEADERBOARD</h3>
                        <div class="daily-leaderboard-list" id="daily-leaderboard-list">
                            <!-- Leaderboard entries will be generated by JavaScript -->
                        </div>
                    </div>
                </div>

                <div class="debrief-actions">
                    <button id="restart-btn" class="btn primary">RE-DEPLOY</button>
                    <button id="menu-btn" class="btn secondary">MAIN MENU</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
        integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <script src="assets/geo-data.js"></script>
    <script src="data.js"></script>
    <script src="app.js"></script>
</body>

</html>